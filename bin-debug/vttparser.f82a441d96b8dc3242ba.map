{"version":3,"sources":["webpack:///./src/js/utils/request-animation-frame.js","webpack:///./src/js/parsers/captions/vttparser.js"],"names":["requestAnimationFrame","window","callback","setTimeout","cancelAnimationFrame","clearTimeout","timestampRegex","integerRegex","fullLineRegex","noteRegex","removeTimestampRegex","colonDelimRegex","stringDelimRegex","whitespaceRegex","arrowRegex","headerRegex","VTTParser","decoder","state","buffer","StringDecoder","regionList","maxCueBatch","decode","data","Error","decodeURIComponent","encodeURIComponent","parseTimeStamp","input","computeSeconds","h","m","s","f","match","replace","Settings","values","Object","create","prototype","set","k","v","get","dflt","defaultKey","has","alt","a","n","length","integer","test","parseInt","percent","parseFloat","parseOptions","keyValueDelim","groupDelim","groups","split","i","kv","defaults","center","align","parseCue","cue","oInput","consumeTimeStamp","ts","consumeCueSettings","inputInner","cueInner","settings","id","region","vals","vals0","vertical","line","lineAlign","snapToLines","size","position","skipWhitespace","startTime","substr","endTime","parse","flushing","self","stream","collectNextLine","pos","errorHandler","oncue","e","alreadyCollectedLine","currentCueBatch","processBuffer","flush","hasSubstring","text","undefined","onflush"],"mappings":"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","file":"vttparser.js","sourcesContent":["export const requestAnimationFrame = window.requestAnimationFrame || function (callback) {\n    return setTimeout(callback, 17);\n};\n\nexport const cancelAnimationFrame = window.cancelAnimationFrame || clearTimeout;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/request-animation-frame.js","/**\n * Copyright 2013 vtt.js Contributors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/*\n* Source: https://github.com/mozilla/vtt.js/blob/v0.13.0/dist/vtt.js#L1718\n*/\n/* eslint-disable no-nested-ternary */\n\nimport { requestAnimationFrame } from 'utils/request-animation-frame';\nimport VTTCue from 'parsers/captions/vttcue';\n\nconst timestampRegex = /^(\\d+):(\\d{2})(:\\d{2})?\\.(\\d{3})/;\nconst integerRegex = /^-?\\d+$/;\nconst fullLineRegex = /\\r\\n|\\n/;\nconst noteRegex = /^NOTE($|[ \\t])/;\nconst removeTimestampRegex = /^[^\\sa-zA-Z-]+/;\nconst colonDelimRegex = /:/;\nconst stringDelimRegex = /\\s/;\nconst whitespaceRegex = /^\\s+/;\nconst arrowRegex = /-->/;\nconst headerRegex = /^WEBVTT([ \\t].*)?$/;\n\nconst VTTParser = function(window, decoder) {\n    this.window = window;\n    this.state = 'INITIAL';\n    this.buffer = '';\n    this.decoder = decoder || new StringDecoder();\n    this.regionList = [];\n    this.maxCueBatch = 1000;\n};\n\nfunction StringDecoder() {\n    return {\n        decode: function(data) {\n            if (!data) {\n                return '';\n            }\n            if (typeof data !== 'string') {\n                throw new Error('Error - expected string data.');\n            }\n            return decodeURIComponent(encodeURIComponent(data));\n        }\n    };\n}\n\n// Try to parse input as a time stamp.\nfunction parseTimeStamp(input) {\n\n    function computeSeconds(h, m, s, f) {\n        return (h | 0) * 3600 + (m | 0) * 60 + (s | 0) + (f | 0) / 1000;\n    }\n\n    var m = input.match(timestampRegex);\n    if (!m) {\n        return null;\n    }\n\n    if (m[3]) {\n        // Timestamp takes the form of [hours]:[minutes]:[seconds].[milliseconds]\n        return computeSeconds(m[1], m[2], m[3].replace(':', ''), m[4]);\n    } else if (m[1] > 59) {\n        // Timestamp takes the form of [hours]:[minutes].[milliseconds]\n        // First position is hours as it's over 59.\n        return computeSeconds(m[1], m[2], 0, m[4]);\n    }\n    // Timestamp takes the form of [minutes]:[seconds].[milliseconds]\n    return computeSeconds(0, m[1], m[2], m[4]);\n}\n\n// A settings object holds key/value pairs and will ignore anything but the first\n// assignment to a specific key.\nfunction Settings() {\n    this.values = Object.create(null);\n}\n\nSettings.prototype = {\n    // Only accept the first assignment to any key.\n    set: function(k, v) {\n        if (!this.get(k) && v !== '') {\n            this.values[k] = v;\n        }\n    },\n    // Return the value for a key, or a default value.\n    // If 'defaultKey' is passed then 'dflt' is assumed to be an object with\n    // a number of possible default values as properties where 'defaultKey' is\n    // the key of the property that will be chosen; otherwise it's assumed to be\n    // a single value.\n    get: function(k, dflt, defaultKey) {\n        if (defaultKey) {\n            return this.has(k) ? this.values[k] : dflt[defaultKey];\n        }\n        return this.has(k) ? this.values[k] : dflt;\n    },\n    // Check whether we have a value for a key.\n    has: function(k) {\n        return k in this.values;\n    },\n    // Accept a setting if its one of the given alternatives.\n    alt: function(k, v, a) {\n        for (var n = 0; n < a.length; ++n) {\n            if (v === a[n]) {\n                this.set(k, v);\n                break;\n            }\n        }\n    },\n    // Accept a setting if its a valid (signed) integer.\n    integer: function(k, v) {\n        if (integerRegex.test(v)) { // integer\n            this.set(k, parseInt(v, 10));\n        }\n    },\n    // Accept a setting if its a valid percentage.\n    percent: function(k, v) {\n        v = parseFloat(v);\n        if (v >= 0 && v <= 100) {\n            this.set(k, v);\n            return true;\n        }\n        return false;\n    }\n};\n\n// Helper function to parse input into groups separated by 'groupDelim', and\n// interprete each group as a key/value pair separated by 'keyValueDelim'.\nfunction parseOptions(input, callback, keyValueDelim, groupDelim) {\n    var groups = groupDelim ? input.split(groupDelim) : [input];\n    for (var i = 0; i <= groups.length; i += 1) {\n        if (typeof groups[i] !== 'string') {\n            continue;\n        }\n        var kv = groups[i].split(keyValueDelim);\n        if (kv.length !== 2) {\n            continue;\n        }\n        var k = kv[0];\n        var v = kv[1];\n        callback(k, v);\n    }\n}\n\nvar defaults = new VTTCue(0, 0, 0);\n// 'middle' was changed to 'center' in the spec: https://github.com/w3c/webvtt/pull/244\n// Chrome and Safari don't yet support this change, but FF does\nvar center = defaults.align === 'middle' ? 'middle' : 'center';\n\nfunction parseCue(input, cue, regionList) {\n    // Remember the original input if we need to throw an error.\n    var oInput = input;\n    // 4.1 WebVTT timestamp\n    function consumeTimeStamp() {\n        var ts = parseTimeStamp(input);\n        if (ts === null) {\n            throw new Error('Malformed timestamp: ' + oInput);\n        }\n        // Remove time stamp from input.\n        input = input.replace(removeTimestampRegex, '');\n        return ts;\n    }\n\n    // 4.4.2 WebVTT cue settings\n    function consumeCueSettings(inputInner, cueInner) {\n        var settings = new Settings();\n\n        parseOptions(inputInner, function (k, v) {\n            switch (k) {\n                case 'region':\n                    // Find the last region we parsed with the same region id.\n                    for (var i = regionList.length - 1; i >= 0; i--) {\n                        if (regionList[i].id === v) {\n                            settings.set(k, regionList[i].region);\n                            break;\n                        }\n                    }\n                    break;\n                case 'vertical':\n                    settings.alt(k, v, ['rl', 'lr']);\n                    break;\n                case 'line': {\n                    const vals = v.split(',');\n                    const vals0 = vals[0];\n                    settings.integer(k, vals0);\n                    if (settings.percent(k, vals0)) {\n                        settings.set('snapToLines', false);\n                    }\n                    settings.alt(k, vals0, ['auto']);\n                    if (vals.length === 2) {\n                        settings.alt('lineAlign', vals[1], ['start', center, 'end']);\n                    }\n                    break;\n                }\n                case 'position': {\n                    const vals = v.split(',');\n                    settings.percent(k, vals[0]);\n                    if (vals.length === 2) {\n                        settings.alt('positionAlign', vals[1], ['start', center, 'end', 'line-left', 'line-right', 'auto']);\n                    }\n                    break;\n                }\n                case 'size':\n                    settings.percent(k, v);\n                    break;\n                case 'align':\n                    settings.alt(k, v, ['start', center, 'end', 'left', 'right']);\n                    break;\n                default:\n            }\n        }, colonDelimRegex, stringDelimRegex);\n\n        // Apply default values for any missing fields.\n        cueInner.region = settings.get('region', null);\n        cueInner.vertical = settings.get('vertical', '');\n        var line = settings.get('line', 'auto');\n        if (line === 'auto' && defaults.line === -1) {\n            // set numeric line number for Safari\n            line = -1;\n        }\n        cueInner.line = line;\n        cueInner.lineAlign = settings.get('lineAlign', 'start');\n        cueInner.snapToLines = settings.get('snapToLines', true);\n        cueInner.size = settings.get('size', 100);\n        cueInner.align = settings.get('align', center);\n        var position = settings.get('position', 'auto');\n        if (position === 'auto' && defaults.position === 50) {\n            // set numeric position for Safari\n            position = cueInner.align === 'start' || cueInner.align === 'left' ? 0 : cueInner.align === 'end' || cueInner.align === 'right' ? 100 : 50;\n        }\n        cueInner.position = position;\n    }\n\n    function skipWhitespace() {\n        input = input.replace(whitespaceRegex, '');\n    }\n\n    // 4.1 WebVTT cue timings.\n    skipWhitespace();\n    cue.startTime = consumeTimeStamp(); // (1) collect cue start time\n    skipWhitespace();\n    if (input.substr(0, 3) !== '-->') { // (3) next characters must match '-->'\n        throw new Error('Malformed time stamp (time stamps must be separated by \\'-->\\'): ' +\n            oInput);\n    }\n    input = input.substr(3);\n    skipWhitespace();\n    cue.endTime = consumeTimeStamp(); // (5) collect cue end time\n\n    // 4.1 WebVTT cue settings list.\n    skipWhitespace();\n    consumeCueSettings(input, cue);\n}\n\nVTTParser.prototype = {\n    parse: function (data, flushing) {\n        var self = this;\n\n        // If there is no data then we won't decode it, but will just try to parse\n        // whatever is in buffer already. This may occur in circumstances, for\n        // example when flush() is called.\n        if (data) {\n            // Try to decode the data that we received.\n            self.buffer += self.decoder.decode(data, { stream: true });\n        }\n\n        function collectNextLine() {\n            var buffer = self.buffer;\n            var pos = 0;\n            while (pos < buffer.length && buffer[pos] !== '\\r' && buffer[pos] !== '\\n') {\n                ++pos;\n            }\n            var line = buffer.substr(0, pos);\n            // Advance the buffer early in case we fail below.\n            if (buffer[pos] === '\\r') {\n                ++pos;\n            }\n            if (buffer[pos] === '\\n') {\n                ++pos;\n            }\n            self.buffer = buffer.substr(pos);\n            return line;\n        }\n\n        // 3.2 WebVTT metadata header syntax\n        // function parseHeader(input) {\n        //     parseOptions(input, function (k, v) {\n        //         switch (k) {\n        //             case 'Region':\n        //                 // 3.3 WebVTT region metadata header syntax\n        //                 console.log('parse region', v);\n        //                 // parseRegion(v);\n        //                 break;\n        //             default:\n        //         }\n        //     }, colonDelimRegex);\n        // }\n\n        function errorHandler() {\n            // If we are currently parsing a cue, report what we have.\n            if (self.state === 'CUETEXT' && self.cue && self.oncue) {\n                self.oncue(self.cue);\n            }\n            self.cue = null;\n            // Enter BADWEBVTT state if header was not parsed correctly otherwise\n            // another exception occurred so enter BADCUE state.\n            self.state = self.state === 'INITIAL' ? 'BADWEBVTT' : 'BADCUE';\n        }\n\n        // 5.1 WebVTT file parsing.\n        try {\n            var line;\n            if (self.state === 'INITIAL') {\n                // We can't start parsing until we have the first line.\n                if (!fullLineRegex.test(self.buffer)) {\n                    return this;\n                }\n\n                line = collectNextLine();\n\n                var m = line.match(headerRegex);\n                if (!m || !m[0]) {\n                    throw new Error('Malformed WebVTT signature.');\n                }\n                self.state = 'HEADER';\n            }\n        } catch (e) {\n            errorHandler();\n            return this;\n        }\n\n        var alreadyCollectedLine = false;\n        var currentCueBatch = 0;\n        function processBuffer() {\n            try {\n                while (self.buffer && currentCueBatch <= self.maxCueBatch) {\n                    // We can't parse a line until we have the full line.\n                    if (!fullLineRegex.test(self.buffer)) {\n                        self.flush();\n                        return this;\n                    }\n\n                    if (!alreadyCollectedLine) {\n                        line = collectNextLine();\n                    } else {\n                        alreadyCollectedLine = false;\n                    }\n\n                    switch (self.state) {\n                        case 'HEADER':\n                            // 13-18 - Allow a header (metadata) under the WEBVTT line.\n                            if (colonDelimRegex.test(line)) {\n                                // parseHeader(line);\n                            } else if (!line) {\n                                // An empty line terminates the header and starts the body (cues).\n                                self.state = 'ID';\n                            }\n                            break;\n                        case 'NOTE':\n                            // Ignore NOTE blocks.\n                            if (!line) {\n                                self.state = 'ID';\n                            }\n                            break;\n                        case 'ID':\n                            // Check for the start of NOTE blocks.\n                            if (noteRegex.test(line)) {\n                                self.state = 'NOTE';\n                                break;\n                            }\n                            // 19-29 - Allow any number of line terminators, then initialize new cue values.\n                            if (!line) {\n                                break;\n                            }\n                            self.cue = new VTTCue(0, 0, '');\n                            self.state = 'CUE';\n                            // 30-39 - Check if self line contains an optional identifier or timing data.\n                            if (!arrowRegex.test(line)) {\n                                self.cue.id = line;\n                                break;\n                            }\n                        // Process line as start of a cue.\n                        /* falls through*/\n                        case 'CUE':\n                            // 40 - Collect cue timings and settings.\n                            try {\n                                parseCue(line, self.cue, self.regionList);\n                            } catch (e) {\n                                // In case of an error ignore rest of the cue.\n                                self.cue = null;\n                                self.state = 'BADCUE';\n                                break;\n                            }\n                            self.state = 'CUETEXT';\n                            break;\n                        case 'CUETEXT':\n                            var hasSubstring = arrowRegex.test(line);\n                            // 34 - If we have an empty line then report the cue.\n                            // 35 - If we have the special substring '-->' then report the cue,\n                            // but do not collect the line as we need to process the current\n                            // one as a new cue.\n                            if (!line || hasSubstring && (alreadyCollectedLine = true)) {\n                                // We are done parsing self cue.\n                                if (self.oncue) {\n                                    currentCueBatch += 1;\n                                    self.oncue(self.cue);\n                                }\n                                self.cue = null;\n                                self.state = 'ID';\n                                break;\n                            }\n                            if (self.cue.text) {\n                                self.cue.text += '\\n';\n                            }\n                            self.cue.text += line;\n                            break;\n                        case 'BADCUE': // BADCUE\n                            // 54-62 - Collect and discard the remaining cue.\n                            if (!line) {\n                                self.state = 'ID';\n                            }\n                            break;\n                        default:\n                    }\n                }\n\n                currentCueBatch = 0;\n                if (self.buffer) {\n                    requestAnimationFrame(processBuffer);\n                } else if (!flushing) {\n                    self.flush();\n                    return this;\n                }\n            } catch (e) {\n                errorHandler(e);\n                return this;\n            }\n        }\n\n        // Immediately process some cues\n        processBuffer();\n    },\n    flush: function () {\n        var self = this;\n        try {\n            // Finish decoding the stream.\n            self.buffer += self.decoder.decode();\n            // Synthesize the end of the current cue or region.\n            if (self.cue || self.state === 'HEADER') {\n                self.buffer += '\\n\\n';\n                self.parse(undefined, true);\n            }\n            // If we've flushed, parsed, and we're still on the INITIAL state then\n            // that means we don't have enough of the stream to parse the first\n            // line.\n            if (self.state === 'INITIAL') {\n                throw new Error('Malformed WebVTT signature.');\n            }\n        } catch (e) {\n            throw e;\n        }\n        if (self.onflush) {\n            self.onflush();\n        }\n        return this;\n    }\n};\n\nexport default VTTParser;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/parsers/captions/vttparser.js"],"sourceRoot":""}