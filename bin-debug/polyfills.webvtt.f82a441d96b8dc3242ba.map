{"version":3,"sources":["webpack:///./src/js/polyfills/webvtt.js"],"names":["ParsingError","errorData","message","name","code","prototype","Object","create","Error","constructor","Errors","BadSignature","BadTimeStamp","parseTimeStamp","input","computeSeconds","h","m","s","f","match","replace","Settings","values","set","k","v","get","dflt","defaultKey","has","alt","a","n","length","integer","test","parseInt","percent","parseFloat","ESCAPE","TAG_NAME","c","i","b","u","ruby","rt","lang","TAG_ANNOTATION","NEEDS_PARENT","parseContent","window","nextToken","consume","result","substr","unescape1","e","unescape","shouldAdd","current","element","localName","createElement","type","annotation","tagName","document","trim","rootDiv","t","tagStack","pop","parentNode","ts","node","createProcessingInstruction","appendChild","className","push","createTextNode","strongRTLRanges","isStrongRTLChar","charCode","currentRange","pushNodes","nodeStack","childNodes","nextTextNode","text","textContent","innerText","determineBidi","cueDiv","charCodeAt","computeLinePos","cue","line","snapToLines","track","textTrackList","mediaElement","trackList","count","mode","StyleBox","applyStyles","styles","div","prop","hasOwnProperty","style","formatStyle","val","unit","CueStyleBox","call","writingMode","vertical","textShadow","position","paddingLeft","paddingRight","left","top","bottom","display","unicodeBidi","textAlign","align","whiteSpace","direction","textPos","size","Math","max","min","width","height","move","box","right","BoxPosition","obj","lh","offsetHeight","offsetWidth","offsetTop","rects","getClientRects","getBoundingClientRect","lineHeight","undefined","ceil","axis","toMove","overlaps","b2","overlapsAny","boxes","within","container","overlapsOppositeAxis","intersectPercentage","x","y","intersectArea","toCSSCompatValues","reference","getSimpleBoxPosition","ret","moveBoxToLinePosition","styleBox","containerBox","boxPositions","numLinesOfText","findBestPosition","bestPosition","specifiedPosition","percentage","p","boxPosition","linePos","step","maxLines","floor","round","maxPosition","initialAxis","abs","textHeight","reverse","calculatedPercentage","lineAlign","WebVTT","StringDecoder","decode","data","decodeURIComponent","encodeURIComponent","convertCueToDOMTree","cuetext","CUE_BACKGROUND_PADDING","shouldCompute","cues","hasBeenReset","displayState","processCues","overlay","updateBoxPosition","firstChild","removeChild","paddedOverlay","margin","currentNumOfLines","reduce","totalLines","split","j","webVttExport"],"mappings":"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","file":"polyfills.webvtt.js","sourcesContent":["/**\n* Copyright 2013 vtt.js Contributors\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\n/* eslint no-unused-expressions: 0, no-nested-ternary: 0 */\n\n// Creates a new ParserError object from an errorData object. The errorData\n// object should have default code and message properties. The default message\n// property can be overriden by passing in a message parameter.\n// See ParsingError.Errors below for acceptable errors.\nfunction ParsingError(errorData, message) {\n    this.name = 'ParsingError';\n    this.code = errorData.code;\n    this.message = message || errorData.message;\n}\n\nParsingError.prototype = Object.create(Error.prototype);\nParsingError.prototype.constructor = ParsingError;\n\n// ParsingError metadata for acceptable ParsingErrors.\nParsingError.Errors = {\n    BadSignature: {\n        code: 0,\n        message: 'Malformed WebVTT signature.'\n    },\n    BadTimeStamp: {\n        code: 1,\n        message: 'Malformed time stamp.'\n    }\n};\n\n// Try to parse input as a time stamp.\nfunction parseTimeStamp(input) {\n\n    function computeSeconds(h, m, s, f) {\n        return (h | 0) * 3600 + (m | 0) * 60 + (s | 0) + (f | 0) / 1000;\n    }\n\n    var m = input.match(/^(\\d+):(\\d{2})(:\\d{2})?\\.(\\d{3})/);\n    if (!m) {\n        return null;\n    }\n\n    if (m[3]) {\n        // Timestamp takes the form of [hours]:[minutes]:[seconds].[milliseconds]\n        return computeSeconds(m[1], m[2], m[3].replace(':', ''), m[4]);\n    } else if (m[1] > 59) {\n        // Timestamp takes the form of [hours]:[minutes].[milliseconds]\n        // First position is hours as it's over 59.\n        return computeSeconds(m[1], m[2], 0, m[4]);\n    }\n    // Timestamp takes the form of [minutes]:[seconds].[milliseconds]\n    return computeSeconds(0, m[1], m[2], m[4]);\n}\n\n// A settings object holds key/value pairs and will ignore anything but the first\n// assignment to a specific key.\nfunction Settings() {\n    this.values = Object.create(null);\n}\n\nSettings.prototype = {\n    // Only accept the first assignment to any key.\n    set: function (k, v) {\n        if (!this.get(k) && v !== '') {\n            this.values[k] = v;\n        }\n    },\n    // Return the value for a key, or a default value.\n    // If 'defaultKey' is passed then 'dflt' is assumed to be an object with\n    // a number of possible default values as properties where 'defaultKey' is\n    // the key of the property that will be chosen; otherwise it's assumed to be\n    // a single value.\n    get: function (k, dflt, defaultKey) {\n        if (defaultKey) {\n            return this.has(k) ? this.values[k] : dflt[defaultKey];\n        }\n        return this.has(k) ? this.values[k] : dflt;\n    },\n    // Check whether we have a value for a key.\n    has: function (k) {\n        return k in this.values;\n    },\n    // Accept a setting if its one of the given alternatives.\n    alt: function (k, v, a) {\n        for (var n = 0; n < a.length; ++n) {\n            if (v === a[n]) {\n                this.set(k, v);\n                break;\n            }\n        }\n    },\n    // Accept a setting if its a valid (signed) integer.\n    integer: function (k, v) {\n        if (/^-?\\d+$/.test(v)) { // integer\n            this.set(k, parseInt(v, 10));\n        }\n    },\n    // Accept a setting if its a valid percentage.\n    percent: function (k, v) {\n        if ((/^[\\d]{1,3}(\\.[\\d]*)?%$/).test(v)) {\n            v = parseFloat(v);\n            if (v >= 0 && v <= 100) {\n                this.set(k, v);\n                return true;\n            }\n        }\n        return false;\n    }\n};\n\nvar ESCAPE = {\n    '&amp;': '&',\n    '&lt;': '<',\n    '&gt;': '>',\n    '&lrm;': '\\u200e',\n    '&rlm;': '\\u200f',\n    '&nbsp;': '\\u00a0'\n};\n\nvar TAG_NAME = {\n    c: 'span',\n    i: 'i',\n    b: 'b',\n    u: 'u',\n    ruby: 'ruby',\n    rt: 'rt',\n    v: 'span',\n    lang: 'span'\n};\n\nvar TAG_ANNOTATION = {\n    v: 'title',\n    lang: 'lang'\n};\n\nvar NEEDS_PARENT = {\n    rt: 'ruby'\n};\n\n// Parse content into a document fragment.\nfunction parseContent(window, input) {\n    function nextToken() {\n        // Check for end-of-string.\n        if (!input) {\n            return null;\n        }\n\n        // Consume 'n' characters from the input.\n        function consume(result) {\n            input = input.substr(result.length);\n            return result;\n        }\n\n        var m = input.match(/^([^<]*)(<[^>]+>?)?/);\n        // If there is some text before the next tag, return it, otherwise return\n        // the tag.\n        return consume(m[1] ? m[1] : m[2]);\n    }\n\n    // Unescape a string 's'.\n    function unescape1(e) {\n        return ESCAPE[e];\n    }\n\n    function unescape(s) {\n        while ((m = s.match(/&(amp|lt|gt|lrm|rlm|nbsp);/))) {\n            s = s.replace(m[0], unescape1);\n        }\n        return s;\n    }\n\n    function shouldAdd(current, element) {\n        return !NEEDS_PARENT[element.localName] ||\n            NEEDS_PARENT[element.localName] === current.localName;\n    }\n\n    // Create an element for this tag.\n    function createElement(type, annotation) {\n        var tagName = TAG_NAME[type];\n        if (!tagName) {\n            return null;\n        }\n        var element = window.document.createElement(tagName);\n        var name = TAG_ANNOTATION[type];\n        if (name && annotation) {\n            element[name] = annotation.trim();\n        }\n        return element;\n    }\n\n    var rootDiv = window.document.createElement('div');\n    var current = rootDiv;\n    var t;\n    var tagStack = [];\n\n    while ((t = nextToken()) !== null) {\n        if (t[0] === '<') {\n            if (t[1] === '/') {\n                // If the closing tag matches, move back up to the parent node.\n                if (tagStack.length &&\n                    tagStack[tagStack.length - 1] === t.substr(2).replace('>', '')) {\n                    tagStack.pop();\n                    current = current.parentNode;\n                }\n                // Otherwise just ignore the end tag.\n                continue;\n            }\n            var ts = parseTimeStamp(t.substr(1, t.length - 2));\n            var node;\n            if (ts) {\n                // Timestamps are lead nodes as well.\n                node = window.document.createProcessingInstruction('timestamp', ts);\n                current.appendChild(node);\n                continue;\n            }\n            var m = t.match(/^<([^.\\s/0-9>]+)(\\.[^\\s\\\\>]+)?([^>\\\\]+)?(\\\\?)>?$/);\n            // If we can't parse the tag, skip to the next tag.\n            if (!m) {\n                continue;\n            }\n            // Try to construct an element, and ignore the tag if we couldn't.\n            node = createElement(m[1], m[3]);\n            if (!node) {\n                continue;\n            }\n            // Determine if the tag should be added based on the context of where it\n            // is placed in the cuetext.\n            if (!shouldAdd(current, node)) {\n                continue;\n            }\n            // Set the class list (as a list of classes, separated by space).\n            if (m[2]) {\n                node.className = m[2].substr(1).replace('.', ' ');\n            }\n            // Append the node to the current node, and enter the scope of the new\n            // node.\n            tagStack.push(m[1]);\n            current.appendChild(node);\n            current = node;\n            continue;\n        }\n\n        // Text nodes are leaf nodes.\n        current.appendChild(window.document.createTextNode(unescape(t)));\n    }\n\n    return rootDiv;\n}\n\n// This is a list of all the Unicode characters that have a strong\n// right-to-left category. What this means is that these characters are\n// written right-to-left for sure. It was generated by pulling all the strong\n// right-to-left characters out of the Unicode data table. That table can\n// found at: http://www.unicode.org/Public/UNIDATA/UnicodeData.txt\nvar strongRTLRanges = [[0x5be, 0x5be], [0x5c0, 0x5c0], [0x5c3, 0x5c3], [0x5c6, 0x5c6],\n    [0x5d0, 0x5ea], [0x5f0, 0x5f4], [0x608, 0x608], [0x60b, 0x60b], [0x60d, 0x60d],\n    [0x61b, 0x61b], [0x61e, 0x64a], [0x66d, 0x66f], [0x671, 0x6d5], [0x6e5, 0x6e6],\n    [0x6ee, 0x6ef], [0x6fa, 0x70d], [0x70f, 0x710], [0x712, 0x72f], [0x74d, 0x7a5],\n    [0x7b1, 0x7b1], [0x7c0, 0x7ea], [0x7f4, 0x7f5], [0x7fa, 0x7fa], [0x800, 0x815],\n    [0x81a, 0x81a], [0x824, 0x824], [0x828, 0x828], [0x830, 0x83e], [0x840, 0x858],\n    [0x85e, 0x85e], [0x8a0, 0x8a0], [0x8a2, 0x8ac], [0x200f, 0x200f],\n    [0xfb1d, 0xfb1d], [0xfb1f, 0xfb28], [0xfb2a, 0xfb36], [0xfb38, 0xfb3c],\n    [0xfb3e, 0xfb3e], [0xfb40, 0xfb41], [0xfb43, 0xfb44], [0xfb46, 0xfbc1],\n    [0xfbd3, 0xfd3d], [0xfd50, 0xfd8f], [0xfd92, 0xfdc7], [0xfdf0, 0xfdfc],\n    [0xfe70, 0xfe74], [0xfe76, 0xfefc], [0x10800, 0x10805], [0x10808, 0x10808],\n    [0x1080a, 0x10835], [0x10837, 0x10838], [0x1083c, 0x1083c], [0x1083f, 0x10855],\n    [0x10857, 0x1085f], [0x10900, 0x1091b], [0x10920, 0x10939], [0x1093f, 0x1093f],\n    [0x10980, 0x109b7], [0x109be, 0x109bf], [0x10a00, 0x10a00], [0x10a10, 0x10a13],\n    [0x10a15, 0x10a17], [0x10a19, 0x10a33], [0x10a40, 0x10a47], [0x10a50, 0x10a58],\n    [0x10a60, 0x10a7f], [0x10b00, 0x10b35], [0x10b40, 0x10b55], [0x10b58, 0x10b72],\n    [0x10b78, 0x10b7f], [0x10c00, 0x10c48], [0x1ee00, 0x1ee03], [0x1ee05, 0x1ee1f],\n    [0x1ee21, 0x1ee22], [0x1ee24, 0x1ee24], [0x1ee27, 0x1ee27], [0x1ee29, 0x1ee32],\n    [0x1ee34, 0x1ee37], [0x1ee39, 0x1ee39], [0x1ee3b, 0x1ee3b], [0x1ee42, 0x1ee42],\n    [0x1ee47, 0x1ee47], [0x1ee49, 0x1ee49], [0x1ee4b, 0x1ee4b], [0x1ee4d, 0x1ee4f],\n    [0x1ee51, 0x1ee52], [0x1ee54, 0x1ee54], [0x1ee57, 0x1ee57], [0x1ee59, 0x1ee59],\n    [0x1ee5b, 0x1ee5b], [0x1ee5d, 0x1ee5d], [0x1ee5f, 0x1ee5f], [0x1ee61, 0x1ee62],\n    [0x1ee64, 0x1ee64], [0x1ee67, 0x1ee6a], [0x1ee6c, 0x1ee72], [0x1ee74, 0x1ee77],\n    [0x1ee79, 0x1ee7c], [0x1ee7e, 0x1ee7e], [0x1ee80, 0x1ee89], [0x1ee8b, 0x1ee9b],\n    [0x1eea1, 0x1eea3], [0x1eea5, 0x1eea9], [0x1eeab, 0x1eebb], [0x10fffd, 0x10fffd]];\n\nfunction isStrongRTLChar(charCode) {\n    for (var i = 0; i < strongRTLRanges.length; i++) {\n        var currentRange = strongRTLRanges[i];\n        if (charCode >= currentRange[0] && charCode <= currentRange[1]) {\n            return true;\n        }\n    }\n\n    return false;\n}\n\nfunction pushNodes(nodeStack, node) {\n    for (var i = node.childNodes.length - 1; i >= 0; i--) {\n        nodeStack.push(node.childNodes[i]);\n    }\n}\n\nfunction nextTextNode(nodeStack) {\n    if (!nodeStack || !nodeStack.length) {\n        return null;\n    }\n\n    var node = nodeStack.pop();\n    var text = node.textContent || node.innerText;\n    if (text) {\n        // TODO: This should match all unicode type B characters (paragraph\n        // separator characters). See issue #115.\n        var m = text.match(/^.*(\\n|\\r)/);\n        if (m) {\n            nodeStack.length = 0;\n            return m[0];\n        }\n        return text;\n    }\n    if (node.tagName === 'ruby') {\n        return nextTextNode(nodeStack);\n    }\n    if (node.childNodes) {\n        pushNodes(nodeStack, node);\n        return nextTextNode(nodeStack);\n    }\n}\n\nfunction determineBidi(cueDiv) {\n    if (!cueDiv || !cueDiv.childNodes) {\n        return 'ltr';\n    }\n\n    var nodeStack = [];\n    var text;\n    var charCode;\n\n    pushNodes(nodeStack, cueDiv);\n    while ((text = nextTextNode(nodeStack))) {\n        for (var i = 0; i < text.length; i++) {\n            charCode = text.charCodeAt(i);\n            if (isStrongRTLChar(charCode)) {\n                return 'rtl';\n            }\n        }\n    }\n    return 'ltr';\n}\n\nfunction computeLinePos(cue) {\n    if (typeof cue.line === 'number' &&\n        (cue.snapToLines || (cue.line >= 0 && cue.line <= 100))) {\n        return cue.line;\n    }\n    if (!cue.track || !cue.track.textTrackList || !cue.track.textTrackList.mediaElement) {\n        return -1;\n    }\n    var track = cue.track;\n    var trackList = track.textTrackList;\n    var count = 0;\n    for (var i = 0; i < trackList.length && trackList[i] !== track; i++) {\n        if (trackList[i].mode === 'showing') {\n            count++;\n        }\n    }\n    return ++count * -1;\n}\n\nfunction StyleBox() {\n}\n\n// Apply styles to a div. If there is no div passed then it defaults to the\n// div on 'this'.\nStyleBox.prototype.applyStyles = function (styles, div) {\n    div = div || this.div;\n    for (var prop in styles) {\n        if (styles.hasOwnProperty(prop)) {\n            div.style[prop] = styles[prop];\n        }\n    }\n};\n\nStyleBox.prototype.formatStyle = function (val, unit) {\n    return val === 0 ? 0 : val + unit;\n};\n\n// Constructs the computed display state of the cue (a div). Places the div\n// into the overlay which should be a block level element (usually a div).\nfunction CueStyleBox(window, cue) {\n\n    StyleBox.call(this);\n    this.cue = cue;\n\n    // Parse our cue's text into a DOM tree rooted at 'cueDiv'. This div will\n    // have inline positioning and will function as the cue background box.\n    this.cueDiv = parseContent(window, cue.text);\n    // Added on 6/21/2016 by Evol Greaves: evol@jwplayer.com for styling captions with CSS\n    this.cueDiv.className = 'jw-text-track-cue jw-reset';\n    let writingMode = 'horizontal-tb';\n\n    if (/^(lr|rl)$/.test(cue.vertical)) {\n        writingMode = 'vertical-' + cue.vertical;\n    }\n\n    var styles = {\n        textShadow: '',\n        position: 'relative',\n        paddingLeft: 0,\n        paddingRight: 0,\n        left: 0,\n        top: 0,\n        bottom: 0,\n        display: 'inline',\n        writingMode,\n        unicodeBidi: 'plaintext',\n    };\n\n    this.applyStyles(styles, this.cueDiv);\n\n    // Create an absolutely positioned div that will be used to position the cue\n    // div. Note, all WebVTT cue-setting alignments are equivalent to the CSS\n    // mirrors of them except \"middle\" which is \"center\" in CSS.\n    this.div = window.document.createElement('div');\n    styles = {\n        textAlign: cue.align === 'middle' ? 'center' : cue.align,\n        whiteSpace: 'pre-line',\n        position: 'absolute',\n        direction: determineBidi(this.cueDiv),\n        writingMode,\n        unicodeBidi: 'plaintext',\n    };\n\n    this.applyStyles(styles);\n\n    this.div.appendChild(this.cueDiv);\n\n    // Calculate the distance from the reference edge of the viewport to the text\n    // position of the cue box. The reference edge will be resolved later when\n    // the box orientation styles are applied.\n    var textPos = 0;\n    // Modified on 10/05/2016 by Evol Greaves: evol@jwplayer.com.\n    // The polyfill used cue.positionAlign to determine whether text should be left,\n    // center or right aligned. However, this value is read only after a cue has been created in FF though the\n    // spec says this value should be settable. See below link:\n    // https://w3c.github.io/webvtt/#ref-for-enumdef-positionalignsetting-1\n    // The cue.align property is settable and other browsers use it as the offset from which the cue.position\n    // value is applied.\n    switch (cue.align) {\n        case 'start':\n        case 'left':\n            textPos = cue.position;\n            break;\n        case 'middle':\n        case 'center':\n            textPos = (cue.position === 'auto' ? 50 : cue.position) - (cue.size / 2);\n            break;\n        case 'end':\n        case 'right':\n            textPos = cue.position - cue.size;\n            break;\n        default:\n            break;\n    }\n\n    // Added on 8/04/2016 by Evol Greaves: evol@jwplayer.com.\n    // Ensures textPos is within the bounds of the cueBox\n    textPos = Math.max(Math.min(100, textPos), 0);\n\n    // Horizontal box orientation; textPos is the distance from the left edge of the\n    // area to the left edge of the box and cue.size is the distance extending to\n    // the right from there.\n    if (!cue.vertical) {\n        this.applyStyles({\n            left: this.formatStyle(textPos, '%'),\n            width: this.formatStyle(cue.size, '%')\n        });\n        // Vertical box orientation; textPos is the distance from the top edge of the\n        // area to the top edge of the box and cue.size is the height extending\n        // downwards from there.\n    } else {\n        this.applyStyles({\n            top: this.formatStyle(textPos, '%'),\n            height: this.formatStyle(cue.size, '%')\n        });\n    }\n\n    this.move = function (box) {\n        this.applyStyles({\n            top: this.formatStyle(box.top, 'px'),\n            bottom: this.formatStyle(box.bottom, 'px'),\n            left: this.formatStyle(box.left, 'px'),\n            paddingRight: this.formatStyle(box.right, 'px'),\n            height: 'auto',\n            width: this.formatStyle(box.width, 'px')\n        });\n    };\n}\n\nCueStyleBox.prototype = Object.create(StyleBox.prototype);\nCueStyleBox.prototype.constructor = CueStyleBox;\n\n// Represents the co-ordinates of an Element in a way that we can easily\n// compute things with such as if it overlaps or intersects with another Element.\n// Can initialize it with either a StyleBox or another BoxPosition.\nfunction BoxPosition(obj) {\n    // Either a BoxPosition was passed in and we need to copy it, or a StyleBox\n    // was passed in and we need to copy the results of 'getBoundingClientRect'\n    // as the object returned is readonly. All co-ordinate values are in reference\n    // to the viewport origin (top left).\n    var lh;\n    if (obj.div) {\n        var height = obj.div.offsetHeight;\n        var width = obj.div.offsetWidth;\n        var top = obj.div.offsetTop;\n\n        var rects = (rects = obj.div.childNodes) && (rects = rects[0]) &&\n            rects.getClientRects && rects.getClientRects();\n        obj = obj.div.getBoundingClientRect();\n        // In certain cases the outter div will be slightly larger then the sum of\n        // the inner div's lines. This could be due to bold text, etc, on some platforms.\n        // In this case we should get the average line height and use that. This will\n        // result in the desired behaviour.\n        lh = rects ? Math.max((rects[0] && rects[0].height) || 0, obj.height / rects.length)\n            : 0;\n\n    }\n    this.left = obj.left;\n    this.right = obj.right;\n    this.top = obj.top || top;\n    this.height = obj.height || height;\n    this.bottom = obj.bottom || (top + (obj.height || height));\n    this.width = obj.width || width;\n    this.lineHeight = lh !== undefined ? lh : obj.lineHeight;\n\n    // Sets the width to be slightly larger to prevent text wrapping in IE 11\n    this.width = Math.ceil(this.width + 1);\n}\n\n// Move the box along a particular axis. Optionally pass in an amount to move\n// the box. If no amount is passed then the default is the line height of the\n// box.\nBoxPosition.prototype.move = function (axis, toMove) {\n    toMove = toMove !== undefined ? toMove : this.lineHeight;\n    switch (axis) {\n        case '+x':\n            this.left += toMove;\n            this.right += toMove;\n            break;\n        case '-x':\n            this.left -= toMove;\n            this.right -= toMove;\n            break;\n        case '+y':\n            this.top += toMove;\n            this.bottom += toMove;\n            break;\n        case '-y':\n            this.top -= toMove;\n            this.bottom -= toMove;\n            break;\n        default:\n            break;\n    }\n};\n\n// Check if this box overlaps another box, b2.\nBoxPosition.prototype.overlaps = function (b2) {\n    return this.left < b2.right &&\n        this.right > b2.left &&\n        this.top < b2.bottom &&\n        this.bottom > b2.top;\n};\n\n// Check if this box overlaps any other boxes in boxes.\nBoxPosition.prototype.overlapsAny = function (boxes) {\n    for (var i = 0; i < boxes.length; i++) {\n        if (this.overlaps(boxes[i])) {\n            return true;\n        }\n    }\n    return false;\n};\n\n// Check if this box is within another box.\nBoxPosition.prototype.within = function (container) {\n    return this.top >= container.top &&\n        this.bottom <= container.bottom &&\n        this.left >= container.left &&\n        this.right <= container.right;\n};\n\n// Check if this box is entirely within the container or it is overlapping\n// on the edge opposite of the axis direction passed. For example, if \"+x\" is\n// passed and the box is overlapping on the left edge of the container, then\n// return true.\nBoxPosition.prototype.overlapsOppositeAxis = function (container, axis) {\n    switch (axis) {\n        case '+x':\n            return this.left < container.left;\n        case '-x':\n            return this.right > container.right;\n        case '+y':\n            return this.top < container.top;\n        case '-y':\n            return this.bottom > container.bottom;\n        default:\n            break;\n    }\n};\n\n// Find the percentage of the area that this box is overlapping with another\n// box.\nBoxPosition.prototype.intersectPercentage = function (b2) {\n    var x = Math.max(0, Math.min(this.right, b2.right) - Math.max(this.left, b2.left));\n    var y = Math.max(0, Math.min(this.bottom, b2.bottom) - Math.max(this.top, b2.top));\n    var intersectArea = x * y;\n    return intersectArea / (this.height * this.width);\n};\n\n// Convert the positions from this box to CSS compatible positions using\n// the reference container's positions. This has to be done because this\n// box's positions are in reference to the viewport origin, whereas, CSS\n// values are in reference to their respective edges.\nBoxPosition.prototype.toCSSCompatValues = function (reference) {\n    return {\n        top: this.top - reference.top,\n        bottom: reference.bottom - this.bottom,\n        left: this.left - reference.left,\n        paddingRight: reference.right - this.right,\n        height: this.height,\n        width: this.width\n    };\n};\n\n// Get an object that represents the box's position without anything extra.\n// Can pass a StyleBox, HTMLElement, or another BoxPositon.\nBoxPosition.getSimpleBoxPosition = function (obj) {\n    var height = obj.div ? obj.div.offsetHeight : obj.tagName ? obj.offsetHeight : 0;\n    var width = obj.div ? obj.div.offsetWidth : obj.tagName ? obj.offsetWidth : 0;\n    var top = obj.div ? obj.div.offsetTop : obj.tagName ? obj.offsetTop : 0;\n\n    obj = obj.div ? obj.div.getBoundingClientRect() :\n        obj.tagName ? obj.getBoundingClientRect() : obj;\n    var ret = {\n        left: obj.left,\n        right: obj.right,\n        top: obj.top || top,\n        height: obj.height || height,\n        bottom: obj.bottom || (top + (obj.height || height)),\n        width: obj.width || width\n    };\n    return ret;\n};\n\n// Move a StyleBox to its specified, or next best, position. The containerBox\n// is the box that contains the StyleBox, such as a div. boxPositions are\n// a list of other boxes that the styleBox can't overlap with.\n// @param numLinesOfText added on 08/03/16 by Evol Greaves evol@jwplayer.com.\n// Puts the cue in the \"best fit\" line if the cue's line would cause text to fall outside the containerBox\nfunction moveBoxToLinePosition(window, styleBox, containerBox, boxPositions, numLinesOfText) {\n\n    // Find the best position for a cue box, b, on the video. The axis parameter\n    // is a list of axis, the order of which, it will move the box along. For example:\n    // Passing [\"+x\", \"-x\"] will move the box first along the x axis in the positive\n    // direction. If it doesn't find a good position for it there it will then move\n    // it along the x axis in the negative direction.\n    function findBestPosition(b, axis) {\n        var bestPosition;\n        var specifiedPosition = new BoxPosition(b);\n        var percentage = 1; // Highest possible so the first thing we get is better.\n\n        for (var i = 0; i < axis.length; i++) {\n            while (b.overlapsOppositeAxis(containerBox, axis[i]) ||\n            (b.within(containerBox) && b.overlapsAny(boxPositions))) {\n                b.move(axis[i]);\n            }\n            // We found a spot where we aren't overlapping anything. This is our\n            // best position.\n            if (b.within(containerBox)) {\n                return b;\n            }\n            var p = b.intersectPercentage(containerBox);\n            // If we're outside the container box less then we were on our last try\n            // then remember this position as the best position.\n            if (percentage > p) {\n                bestPosition = new BoxPosition(b);\n                percentage = p;\n            }\n            // Reset the box position to the specified position.\n            b = new BoxPosition(specifiedPosition);\n        }\n        return bestPosition || specifiedPosition;\n    }\n\n    var boxPosition = new BoxPosition(styleBox);\n    var cue = styleBox.cue;\n    var linePos = computeLinePos(cue);\n    var axis = [];\n\n    // If we have a line number to align the cue to.\n    if (cue.snapToLines) {\n        var size;\n        switch (cue.vertical) {\n            case '':\n                axis = ['+y', '-y'];\n                size = 'height';\n                break;\n            case 'rl':\n                axis = ['+x', '-x'];\n                size = 'width';\n                break;\n            case 'lr':\n                axis = ['-x', '+x'];\n                size = 'width';\n                break;\n            default:\n                break;\n        }\n\n        var step = boxPosition.lineHeight;\n        // maxLines added on 8/03/2016 by Evol Greaves: evol@jwplayer.com.\n        // This ensures that cues are positioned according to the maximum number of lines\n        // that can be displayed based on the container size.\n        // The position also needs to account for the number of lines of text to ensure\n        // text isn't cut off at the bottom of the container\n        var maxLines = Math.floor(containerBox[size] / step);\n        linePos = Math.min(linePos, maxLines - numLinesOfText);\n        var position = step * Math.round(linePos);\n        var maxPosition = containerBox[size] + step;\n        var initialAxis = axis[0];\n\n        // If the specified initial position is greater than the max position, then\n        // clamp the box to the amount of steps it would take for the box to\n        // reach the max position.\n        if (Math.abs(position) > maxPosition) {\n            position = position < 0 ? -1 : 1;\n            position *= Math.ceil(maxPosition / step) * step;\n        }\n\n        // If computed line position returns negative then line numbers are\n        // relative to the bottom of the video instead of the top. Therefore, we\n        // need to increase our initial position by the length or width of the\n        // video, depending on the writing direction, and reverse our axis directions.\n        if (linePos < 0) {\n            position += cue.vertical ? containerBox.width : containerBox.height;\n            // textHeight added on 8/04/2016 by Evol Greaves: evol@jwplayer.com\n            // Account for lines of text when determining position based on a negative line value\n            var textHeight = numLinesOfText * step;\n            position -= textHeight;\n            axis = axis.reverse();\n        }\n\n        // Shift the position of the captions up to prevent minor overlaps as the text is laid out in IE11\n        position -= numLinesOfText;\n\n        // Move the box to the specified position. This may not be its best\n        // position.\n        boxPosition.move(initialAxis, position);\n    } else {\n        // If we have a percentage line value for the cue.\n        var calculatedPercentage = (boxPosition.lineHeight / containerBox.height) * 100;\n\n        switch (cue.lineAlign) {\n            case 'middle':\n                linePos -= (calculatedPercentage / 2);\n                break;\n            case 'end':\n                linePos -= calculatedPercentage;\n                break;\n            default:\n                break;\n        }\n\n        // Apply initial line position to the cue box.\n        switch (cue.vertical) {\n            case '':\n                styleBox.applyStyles({\n                    top: styleBox.formatStyle(linePos, '%')\n                });\n                break;\n            case 'rl':\n                styleBox.applyStyles({\n                    left: styleBox.formatStyle(linePos, '%')\n                });\n                break;\n            case 'lr':\n                styleBox.applyStyles({\n                    paddingRight: styleBox.formatStyle(linePos, '%')\n                });\n                break;\n            default:\n                break;\n        }\n\n        axis = ['+y', '-x', '+x', '-y'];\n\n        // Get the box position again after we've applied the specified positioning\n        // to it.\n        boxPosition = new BoxPosition(styleBox);\n    }\n\n    var bestPosition = findBestPosition(boxPosition, axis);\n    styleBox.move(bestPosition.toCSSCompatValues(containerBox));\n}\n\nfunction WebVTT() {\n    // Nothing\n}\n\n// Helper to allow strings to be decoded instead of the default binary utf8 data.\nWebVTT.StringDecoder = function () {\n    return {\n        decode: function (data) {\n            if (!data) {\n                return '';\n            }\n            if (typeof data !== 'string') {\n                throw new Error('Error - expected string data.');\n            }\n            return decodeURIComponent(encodeURIComponent(data));\n        }\n    };\n};\n\nWebVTT.convertCueToDOMTree = function (window, cuetext) {\n    if (!window || !cuetext) {\n        return null;\n    }\n    return parseContent(window, cuetext);\n};\n\nvar CUE_BACKGROUND_PADDING = '1.5%';\n\n\n// Determine if we need to compute the display states of the cues. This could\n// be the case if a cue's state has been changed since the last computation or\n// if it has not been computed yet.\nfunction shouldCompute(cues) {\n    for (var i = 0; i < cues.length; i++) {\n        if (cues[i].hasBeenReset || !cues[i].displayState) {\n            return true;\n        }\n    }\n    return false;\n}\n\n// Runs the processing model over the cues and regions passed to it.\n// @param overlay A block level element (usually a div) that the computed cues\n//                and regions will be placed into.\n// @param updateBoxPosition added on 6/29/2016 by Evol Greaves: evol@jwplayer.com.\n// This ensures that cues are displayed within the overlay whenever its size changes\nWebVTT.processCues = function (window, cues, overlay, updateBoxPosition) {\n    if (!window || !cues || !overlay) {\n        return null;\n    }\n\n    // Remove all previous children.\n    while (overlay.firstChild) {\n        overlay.removeChild(overlay.firstChild);\n    }\n\n    // Return early if there are no cues to process\n    if (!cues.length) {\n        return null;\n    }\n\n    var paddedOverlay = window.document.createElement('div');\n    // Added on 6/21/2016 by Evol Greaves: evol@jwplayer.com for styling captions with CSS\n    paddedOverlay.className = 'jw-text-track-container jw-reset';\n    paddedOverlay.style.position = 'absolute';\n    paddedOverlay.style.left = '0';\n    paddedOverlay.style.right = '0';\n    paddedOverlay.style.top = '0';\n    paddedOverlay.style.bottom = '0';\n    paddedOverlay.style.margin = CUE_BACKGROUND_PADDING;\n    overlay.appendChild(paddedOverlay);\n\n    // We don't need to recompute the cues' display states. Just reuse them.\n    if (!shouldCompute(cues) && !updateBoxPosition) {\n        for (var i = 0; i < cues.length; i++) {\n            paddedOverlay.appendChild(cues[i].displayState);\n        }\n        return;\n    }\n\n    var boxPositions = [];\n    var containerBox = BoxPosition.getSimpleBoxPosition(paddedOverlay);\n    var currentNumOfLines = cues.reduce(function(totalLines, cue) {\n        return totalLines + cue.text.split('\\n').length;\n    }, 0);\n\n    (function () {\n        for (var j = 0; j < cues.length; j++) {\n            var cue = cues[j];\n\n            // Compute the initial position and styles of the cue div.\n            var styleBox = new CueStyleBox(window, cue);\n            // Added on 6/21/2016 by Evol Greaves: evol@jwplayer.com for styling captions with CSS\n            styleBox.div.className = 'jw-text-track-display jw-reset';\n            paddedOverlay.appendChild(styleBox.div);\n\n            // Move the cue div to it's correct line position.\n            // Added on 08/03/2016 by Evol Greaves: evol@jwplayer.com for determining the correct\n            // position to place the containerBox.\n            moveBoxToLinePosition(window, styleBox, containerBox, boxPositions, currentNumOfLines);\n            currentNumOfLines -= cue.text.split('\\n').length;\n\n            // Remember the computed div so that we don't have to recompute it later\n            // if we don't have too.\n            cue.displayState = styleBox.div;\n\n            boxPositions.push(BoxPosition.getSimpleBoxPosition(styleBox));\n        }\n    }());\n};\n\nlet webVttExport = window.WebVTT;\nif (!webVttExport) {\n    window.WebVTT = webVttExport = WebVTT;\n}\n\nexport default webVttExport;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/polyfills/webvtt.js"],"sourceRoot":""}